<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Captain Alison's Adventure Game - Lesson 12</title>
    <link href="https://cdn.bootcdn.net/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
    <script src="https://cdn.bootcdn.net/ajax/libs/vue/3.3.4/vue.global.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Fredoka+One:wght@400&family=Nunito:wght@400;600;700&display=swap');
        
        body {
            font-family: 'Nunito', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .game-title {
            font-family: 'Fredoka One', cursive;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .boat-animation {
            animation: float 3s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(-2deg); }
            50% { transform: translateY(-10px) rotate(2deg); }
        }
        
        .wave-animation {
            animation: wave 2s ease-in-out infinite;
        }
        
        @keyframes wave {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-5px); }
        }
        
        .drag-item {
            cursor: grab;
            transition: all 0.3s ease;
        }
        
        .drag-item:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
        }
        
        .drag-item.dragging {
            cursor: grabbing;
            transform: rotate(5deg) scale(1.1);
            z-index: 1000;
        }
        
        .drop-zone {
            transition: all 0.3s ease;
            border: 2px dashed #cbd5e0;
        }
        
        .drop-zone.drag-over {
            border-color: #4299e1;
            background-color: #ebf8ff;
            transform: scale(1.02);
        }
        
        .drop-zone.correct {
            border-color: #48bb78;
            background-color: #f0fff4;
        }
        
        .drop-zone.incorrect {
            border-color: #f56565;
            background-color: #fff5f5;
            animation: shake 0.5s ease-in-out;
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        
        .sailing-boat {
            transition: all 1s ease-in-out;
        }
        
        .treasure-sparkle {
            animation: sparkle 1.5s ease-in-out infinite;
        }
        
        @keyframes sparkle {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.2); }
        }
        
        .score-popup {
            animation: scorePopup 0.8s ease-out;
        }
        
        @keyframes scorePopup {
            0% { transform: scale(0) translateY(0); opacity: 0; }
            50% { transform: scale(1.2) translateY(-20px); opacity: 1; }
            100% { transform: scale(1) translateY(-30px); opacity: 0; }
        }
        
        .celebration {
            animation: celebration 2s ease-in-out;
        }
        
        @keyframes celebration {
            0%, 100% { transform: scale(1); }
            25% { transform: scale(1.1) rotate(-5deg); }
            75% { transform: scale(1.1) rotate(5deg); }
        }
        
        .game-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
            transition: all 0.3s ease;
        }
        
        [v-cloak] {
            display: none !important;
        }
        
        .ocean-bg {
            background: linear-gradient(180deg, #87CEEB 0%, #4682B4 50%, #191970 100%);
            position: relative;
            overflow: hidden;
        }
        
        .cloud {
            position: absolute;
            background: white;
            border-radius: 50px;
            opacity: 0.8;
            animation: cloudMove 20s linear infinite;
        }
        
        @keyframes cloudMove {
            0% { transform: translateX(-100px); }
            100% { transform: translateX(calc(100vw + 100px)); }
        }
    </style>
</head>
<body>
    <div id="app" class="min-h-screen" v-cloak>
        <!-- Header -->
        <div class="bg-white shadow-lg">
            <div class="container mx-auto px-4 py-4">
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-4">
                        <div class="text-4xl boat-animation">‚õµ</div>
                        <div>
                            <h1 class="text-3xl font-bold text-blue-600 game-title">Captain Alison's Adventure</h1>
                            <p class="text-gray-600">Lesson 12 Interactive Game</p>
                        </div>
                    </div>
                    <div class="flex items-center space-x-4">
                        <div class="bg-yellow-100 px-4 py-2 rounded-lg">
                            <span class="text-yellow-800 font-semibold">Score: <span v-text="totalScore"></span></span>
                        </div>
                        <div class="bg-blue-100 px-4 py-2 rounded-lg">
                            <span class="text-blue-800 font-semibold">Level: <span v-text="currentLevel"></span></span>
                        </div>
                        <div v-if="currentGame !== 'menu'" class="bg-green-100 px-4 py-2 rounded-lg">
                            <span class="text-green-800 font-semibold">‚è±Ô∏è <span v-text="formatTime(gameTimer)"></span></span>
                        </div>
                        <div v-if="currentGame !== 'menu'" class="bg-red-100 px-4 py-2 rounded-lg">
                            <span class="text-red-800 font-semibold">‚ù§Ô∏è <span v-text="lives"></span></span>
                        </div>
                        <button @click="showDifficultySelector = true" class="bg-purple-100 px-4 py-2 rounded-lg hover:bg-purple-200">
                            <span class="text-purple-800 font-semibold" v-text="difficulty.toUpperCase()"></span>
                        </button>
                        <button @click="showAchievements = true" class="bg-orange-100 px-4 py-2 rounded-lg hover:bg-orange-200">
                            <span class="text-orange-800 font-semibold">üèÜ Achievements</span>
                        </button>
                        <button @click="toggleLeaderboard()" class="bg-yellow-100 px-4 py-2 rounded-lg hover:bg-yellow-200">
                            <span class="text-yellow-800 font-semibold">üìä Leaderboard</span>
                        </button>
                        <button @click="toggleSound()" class="px-4 py-2 rounded-lg hover:bg-gray-200" :class="soundEnabled ? 'bg-green-100' : 'bg-gray-100'">
                            <span class="font-semibold" :class="soundEnabled ? 'text-green-800' : 'text-gray-600'" v-text="soundEnabled ? 'üîä' : 'üîá'"></span>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Game Selection Menu -->
        <div v-if="currentGame === 'menu'" class="ocean-bg min-h-screen relative">
            <!-- Animated Background Elements -->
            <div class="cloud" style="top: 10%; width: 80px; height: 40px; animation-delay: 0s;"></div>
            <div class="cloud" style="top: 20%; width: 120px; height: 60px; animation-delay: 5s;"></div>
            <div class="cloud" style="top: 15%; width: 100px; height: 50px; animation-delay: 10s;"></div>
            
            <div class="container mx-auto px-4 py-12">
                <div class="text-center mb-12">
                    <h2 class="text-5xl font-bold text-white game-title mb-4">Welcome Aboard!</h2>
                    <p class="text-xl text-white">Help Captain Charles Alison prepare for his Atlantic adventure!</p>
                </div>
                
                <div class="grid md:grid-cols-3 gap-8 max-w-6xl mx-auto">
                    <!-- Game 1: Word Matching -->
                    <div class="game-card bg-white rounded-xl shadow-2xl p-6 transform transition-all duration-300 cursor-pointer" @click="startGame('wordMatch')">
                        <div class="text-center">
                            <div class="text-6xl mb-4">üéØ</div>
                            <h3 class="text-2xl font-bold text-blue-600 mb-2">Word Harbor</h3>
                            <p class="text-gray-600 mb-4">Match vocabulary words with their meanings</p>
                            <div class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-semibold">
                                Easy ‚Ä¢ 10 Points
                            </div>
                        </div>
                    </div>
                    
                    <!-- Game 2: Story Sequencing -->
                    <div class="game-card bg-white rounded-xl shadow-2xl p-6 transform transition-all duration-300 cursor-pointer" @click="startGame('storySequence')">
                        <div class="text-center">
                            <div class="text-6xl mb-4">üìö</div>
                            <h3 class="text-2xl font-bold text-green-600 mb-2">Story Voyage</h3>
                            <p class="text-gray-600 mb-4">Put the story events in correct order</p>
                            <div class="bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-semibold">
                                Medium ‚Ä¢ 20 Points
                            </div>
                        </div>
                    </div>
                    
                    <!-- Game 3: Sailing Adventure -->
                    <div class="game-card bg-white rounded-xl shadow-2xl p-6 transform transition-all duration-300 cursor-pointer" @click="startGame('sailingAdventure')">
                        <div class="text-center">
                            <div class="text-6xl mb-4">üèÜ</div>
                            <h3 class="text-2xl font-bold text-purple-600 mb-2">Atlantic Race</h3>
                            <p class="text-gray-600 mb-4">Navigate Topsail across the Atlantic</p>
                            <div class="bg-purple-100 text-purple-800 px-3 py-1 rounded-full text-sm font-semibold">
                                Hard ‚Ä¢ 30 Points
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Progress Summary -->
                <div class="mt-12 bg-white bg-opacity-90 rounded-xl p-6 max-w-2xl mx-auto">
                    <h3 class="text-xl font-bold text-center mb-4">Your Progress</h3>
                    <div class="grid grid-cols-3 gap-4 text-center">
                        <div>
                            <div class="text-2xl font-bold text-blue-600" v-text="gamesCompleted"></div>
                            <div class="text-sm text-gray-600">Games Completed</div>
                        </div>
                        <div>
                            <div class="text-2xl font-bold text-green-600" v-text="totalScore"></div>
                            <div class="text-sm text-gray-600">Total Score</div>
                        </div>
                        <div>
                            <div class="text-2xl font-bold text-purple-600" v-text="Math.round(averageScore) + '%'"></div>
                            <div class="text-sm text-gray-600">Average Score</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Game 1: Word Matching -->
        <div v-if="currentGame === 'wordMatch'" class="container mx-auto px-4 py-8">
            <div class="bg-white rounded-xl shadow-lg p-6">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-blue-600">üéØ Word Harbor - Match the Words!</h2>
                    <button @click="currentGame = 'menu'" class="bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600">
                        Back to Menu
                    </button>
                </div>
                
                <div class="mb-6">
                    <div class="bg-blue-50 p-4 rounded-lg">
                        <p class="text-blue-800 font-semibold">Instructions: Drag the words to match them with their correct meanings!</p>
                        <div class="mt-2">
                            <span class="text-sm text-blue-600">Progress: <span v-text="wordMatchProgress"></span>/<span v-text="wordPairs.length"></span> ‚Ä¢ Score: <span v-text="wordMatchScore"></span></span>
                        </div>
                    </div>
                </div>
                
                <div class="grid md:grid-cols-2 gap-8">
                    <!-- Words Column -->
                    <div>
                        <h3 class="text-lg font-semibold mb-4 text-center">üìù Words</h3>
                        <div class="space-y-3">
                            <div 
                                v-for="word in shuffledWords" 
                                :key="word.id"
                                :class="['drag-item bg-blue-100 p-4 rounded-lg text-center font-semibold cursor-grab', word.matched ? 'opacity-50' : '']"
                                :draggable="!word.matched"
                                @dragstart="dragStart($event, word)"
                                @dragend="dragEnd"
                                v-text="word.word"
                            >
                            </div>
                        </div>
                    </div>
                    
                    <!-- Meanings Column -->
                    <div>
                        <h3 class="text-lg font-semibold mb-4 text-center">üí° Meanings</h3>
                        <div class="space-y-3">
                            <div 
                                v-for="meaning in shuffledMeanings" 
                                :key="meaning.id"
                                :class="['drop-zone p-4 rounded-lg text-center min-h-16 flex items-center justify-center', 
                                        meaning.matched ? 'correct' : '',
                                        meaning.dragOver ? 'drag-over' : '',
                                        meaning.incorrect ? 'incorrect' : 'bg-green-50']"
                                @dragover.prevent="dragOver($event, meaning)"
                                @dragleave="dragLeave(meaning)"
                                @drop="drop($event, meaning)"
                            >
                                <span v-if="meaning.matched" class="text-green-800 font-semibold">
                                    ‚úÖ <span v-text="meaning.matchedWord"></span> - <span v-text="meaning.meaning"></span>
                                </span>
                                <span v-else class="text-gray-600" v-text="meaning.meaning">
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Completion Message -->
                <div v-if="wordMatchComplete" class="mt-8 text-center">
                    <div class="celebration bg-green-100 p-6 rounded-xl">
                        <div class="text-4xl mb-2">üéâ</div>
                        <h3 class="text-2xl font-bold text-green-600 mb-2">Excellent Work!</h3>
                        <p class="text-green-800">You've mastered all the vocabulary! Score: <span v-text="wordMatchScore"></span> points</p>
                        <button @click="currentGame = 'menu'" class="mt-4 bg-blue-500 text-white px-6 py-2 rounded-lg hover:bg-blue-600">
                            Continue Adventure
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Game 2: Story Sequencing -->
        <div v-if="currentGame === 'storySequence'" class="container mx-auto px-4 py-8">
            <div class="bg-white rounded-xl shadow-lg p-6">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-green-600">üìö Story Voyage - Order the Events!</h2>
                    <button @click="currentGame = 'menu'" class="bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600">
                        Back to Menu
                    </button>
                </div>
                
                <div class="mb-6">
                    <div class="bg-green-50 p-4 rounded-lg">
                        <p class="text-green-800 font-semibold">Instructions: Drag the story events to put them in the correct order!</p>
                        <div class="mt-2">
                            <span class="text-sm text-green-600">Attempts: <span v-text="sequenceAttempts"></span> ‚Ä¢ Score: <span v-text="sequenceScore"></span></span>
                        </div>
                    </div>
                </div>
                
                <div class="grid md:grid-cols-2 gap-8">
                    <!-- Scrambled Events -->
                    <div>
                        <h3 class="text-lg font-semibold mb-4 text-center">üîÄ Story Events</h3>
                        <div class="space-y-3">
                            <div 
                                v-for="event in scrambledEvents" 
                                :key="event.id"
                                :class="['drag-item bg-yellow-100 p-4 rounded-lg cursor-grab', event.placed ? 'opacity-50' : '']"
                                :draggable="!event.placed"
                                @dragstart="dragStart($event, event)"
                                @dragend="dragEnd"
                            >
                                <div class="font-semibold text-yellow-800" v-text="event.text"></div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Sequence Slots -->
                    <div>
                        <h3 class="text-lg font-semibold mb-4 text-center">üìã Correct Order</h3>
                        <div class="space-y-3">
                            <div 
                                v-for="(slot, index) in sequenceSlots" 
                                :key="index"
                                :class="['drop-zone p-4 rounded-lg min-h-20 flex items-center justify-center border-2 border-dashed',
                                        slot.correct ? 'correct' : '',
                                        slot.dragOver ? 'drag-over' : 'bg-blue-50 border-blue-300']"
                                @dragover.prevent="dragOver($event, slot)"
                                @dragleave="dragLeave(slot)"
                                @drop="dropSequence($event, slot, index)"
                            >
                                <div v-if="slot.event" class="text-center">
                                    <div class="font-bold text-blue-600" v-text="(index + 1) + '.'"></div>
                                    <div class="text-sm" v-text="slot.event.text"></div>
                                </div>
                                <div v-else class="text-gray-400 text-center">
                                    <div class="font-bold" v-text="(index + 1) + '.'"></div>
                                    <div class="text-sm">Drop event here</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="mt-6 text-center">
                    <button 
                        @click="checkSequence" 
                        :disabled="!allSlotsFilled"
                        :class="['px-6 py-3 rounded-lg font-semibold', allSlotsFilled ? 'bg-green-500 text-white hover:bg-green-600' : 'bg-gray-300 text-gray-500 cursor-not-allowed']"
                    >
                        Check Order
                    </button>
                </div>
                
                <!-- Completion Message -->
                <div v-if="sequenceComplete" class="mt-8 text-center">
                    <div class="celebration bg-green-100 p-6 rounded-xl">
                        <div class="text-4xl mb-2">üéâ</div>
                        <h3 class="text-2xl font-bold text-green-600 mb-2">Perfect Sequence!</h3>
                        <p class="text-green-800">You've arranged the story perfectly! Score: <span v-text="sequenceScore"></span> points</p>
                        <button @click="currentGame = 'menu'" class="mt-4 bg-blue-500 text-white px-6 py-2 rounded-lg hover:bg-blue-600">
                            Continue Adventure
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Game 3: Sailing Adventure -->
        <div v-if="currentGame === 'sailingAdventure'" class="ocean-bg min-h-screen relative">
            <div class="container mx-auto px-4 py-8">
                <div class="bg-white bg-opacity-95 rounded-xl shadow-lg p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-purple-600">üèÜ Atlantic Race - Navigate Topsail!</h2>
                        <button @click="currentGame = 'menu'" class="bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600">
                            Back to Menu
                        </button>
                    </div>
                    
                    <div class="mb-6">
                        <div class="bg-purple-50 p-4 rounded-lg">
                            <p class="text-purple-800 font-semibold">Instructions: Answer questions correctly to help Captain Alison sail across the Atlantic!</p>
                            <div class="mt-2 flex justify-between">
                                <span class="text-sm text-purple-600">Progress: <span v-text="sailingProgress"></span>% ‚Ä¢ Score: <span v-text="sailingScore"></span></span>
                                <span class="text-sm text-purple-600">Lives: <span v-text="'‚ù§Ô∏è'.repeat(sailingLives)"></span></span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Sailing Game Area -->
                    <div class="bg-gradient-to-b from-blue-200 to-blue-400 rounded-xl p-6 min-h-[500px] relative overflow-visible">
                        <!-- Boat Position -->
                        <div 
                            class="sailing-boat absolute text-4xl"
                            :style="{ left: boatPosition + '%', top: '40%' }"
                        >
                            ‚õµ
                        </div>
                        
                        <!-- Progress Islands -->
                        <div class="absolute top-4 left-4 text-2xl">üèùÔ∏è Portsmouth</div>
                        <div class="absolute top-8 right-4 text-2xl treasure-sparkle">üèÜ Atlantic Finish</div>
                        
                        <!-- Waves -->
                        <div class="absolute bottom-0 left-0 right-0 h-16 bg-blue-500 wave-animation opacity-70"></div>
                    </div>
                    
                    <!-- Current Question -->
                    <div v-if="currentSailingQuestion" class="mt-6 bg-white rounded-lg p-6 shadow-lg max-w-2xl mx-auto">
                        <h4 class="font-bold mb-3" v-text="currentSailingQuestion.question"></h4>
                        <div class="space-y-2">
                            <button 
                                v-for="(option, index) in currentSailingQuestion.options" 
                                :key="index"
                                @click="answerSailingQuestion(index)"
                                class="w-full text-left p-2 rounded bg-blue-50 hover:bg-blue-100 transition-colors"
                                v-text="option"
                            >
                            </button>
                        </div>
                    </div>
                    
                    <!-- Game Over / Win Message -->
                    <div v-if="sailingGameOver" class="mt-6 bg-white rounded-xl p-8 text-center max-w-2xl mx-auto shadow-lg">
                        <div v-if="sailingWon" class="celebration">
                            <div class="text-6xl mb-4">üèÜ</div>
                            <h3 class="text-2xl font-bold text-green-600 mb-2">Victory!</h3>
                            <p class="text-green-800 mb-4">Captain Alison completed the Atlantic race! Score: <span v-text="sailingScore"></span> points</p>
                        </div>
                        <div v-else>
                            <div class="text-6xl mb-4">‚öì</div>
                            <h3 class="text-2xl font-bold text-red-600 mb-2">Game Over</h3>
                            <p class="text-red-800 mb-4">The journey was too challenging this time. Score: <span v-text="sailingScore"></span> points</p>
                        </div>
                        <button @click="resetSailingGame" class="bg-blue-500 text-white px-6 py-2 rounded-lg hover:bg-blue-600 mr-2">
                            Try Again
                        </button>
                        <button @click="currentGame = 'menu'" class="bg-gray-500 text-white px-6 py-2 rounded-lg hover:bg-gray-600">
                            Back to Menu
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Leaderboard Modal -->
        <div v-if="showLeaderboard" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
            <div class="bg-white rounded-lg p-8 max-w-lg w-full mx-4 max-h-96 overflow-y-auto">
                <h3 class="text-2xl font-bold text-center mb-6">üìä Leaderboard</h3>
                <div v-if="leaderboard.length === 0" class="text-center text-gray-500 py-8">
                    No scores yet! Complete at least 3 games to qualify for the leaderboard.
                </div>
                <div v-else class="space-y-3">
                    <div v-for="(entry, index) in leaderboard" :key="index" class="flex items-center p-3 rounded-lg bg-gradient-to-r from-yellow-50 to-orange-50 border border-yellow-200">
                        <div class="text-2xl mr-3" v-text="getMedalIcon(index)"></div>
                        <div class="flex-1">
                            <div class="font-bold text-gray-800" v-text="entry.name"></div>
                            <div class="text-sm text-gray-600">
                                <span v-text="entry.score"></span> points ‚Ä¢ 
                                <span v-text="entry.gamesCompleted"></span> games ‚Ä¢ 
                                <span v-text="entry.difficulty"></span>
                            </div>
                            <div class="text-xs text-gray-500" v-text="entry.date"></div>
                        </div>
                        <div class="text-lg font-bold text-yellow-600">#<span v-text="index + 1"></span></div>
                    </div>
                </div>
                <div class="flex gap-3 mt-6">
                    <button @click="showLeaderboard = false" class="flex-1 bg-gray-500 text-white py-2 rounded-lg hover:bg-gray-600">
                        Close
                    </button>
                    <button v-if="leaderboard.length > 0" @click="clearLeaderboard()" class="bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600">
                        Clear
                    </button>
                </div>
            </div>
        </div>

        <!-- Score Popup -->
        <div v-if="showScorePopup" class="fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-50">
            <div class="score-popup bg-yellow-400 text-yellow-900 px-6 py-3 rounded-full font-bold text-xl">
                +<span v-text="lastScoreGain"></span> points!
            </div>
        </div>

        <!-- Difficulty Selector Modal -->
        <div v-if="showDifficultySelector" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
            <div class="bg-white rounded-lg p-8 max-w-md w-full mx-4">
                <h3 class="text-2xl font-bold text-center mb-6">Select Difficulty</h3>
                <div class="space-y-4">
                    <button @click="setDifficulty('easy')" class="w-full p-4 rounded-lg border-2 hover:bg-green-50" :class="difficulty === 'easy' ? 'border-green-500 bg-green-50' : 'border-gray-300'">
                        <div class="text-left">
                            <div class="font-bold text-green-600">üü¢ EASY</div>
                            <div class="text-sm text-gray-600">2 minutes ‚Ä¢ 5 lives ‚Ä¢ 1x score</div>
                        </div>
                    </button>
                    <button @click="setDifficulty('medium')" class="w-full p-4 rounded-lg border-2 hover:bg-yellow-50" :class="difficulty === 'medium' ? 'border-yellow-500 bg-yellow-50' : 'border-gray-300'">
                        <div class="text-left">
                            <div class="font-bold text-yellow-600">üü° MEDIUM</div>
                            <div class="text-sm text-gray-600">1.5 minutes ‚Ä¢ 3 lives ‚Ä¢ 1.5x score</div>
                        </div>
                    </button>
                    <button @click="setDifficulty('hard')" class="w-full p-4 rounded-lg border-2 hover:bg-red-50" :class="difficulty === 'hard' ? 'border-red-500 bg-red-50' : 'border-gray-300'">
                        <div class="text-left">
                            <div class="font-bold text-red-600">üî¥ HARD</div>
                            <div class="text-sm text-gray-600">1 minute ‚Ä¢ 1 life ‚Ä¢ 2x score</div>
                        </div>
                    </button>
                </div>
                <button @click="showDifficultySelector = false" class="w-full mt-6 bg-gray-500 text-white py-2 rounded-lg hover:bg-gray-600">
                    Close
                </button>
            </div>
        </div>

        <!-- Achievements Modal -->
        <div v-if="showAchievements" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
            <div class="bg-white rounded-lg p-8 max-w-lg w-full mx-4 max-h-96 overflow-y-auto">
                <h3 class="text-2xl font-bold text-center mb-6">üèÜ Achievements</h3>
                <div class="space-y-3">
                    <div v-for="achievement in achievements" :key="achievement.id" class="flex items-center p-3 rounded-lg" :class="achievement.unlocked ? 'bg-yellow-50 border border-yellow-200' : 'bg-gray-50 border border-gray-200'">
                        <div class="text-2xl mr-3" :class="achievement.unlocked ? '' : 'grayscale opacity-50'" v-text="achievement.icon"></div>
                        <div class="flex-1">
                            <div class="font-bold" :class="achievement.unlocked ? 'text-yellow-800' : 'text-gray-500'" v-text="achievement.name"></div>
                            <div class="text-sm" :class="achievement.unlocked ? 'text-yellow-600' : 'text-gray-400'" v-text="achievement.description"></div>
                        </div>
                        <div v-if="achievement.unlocked" class="text-yellow-500 font-bold">‚úì</div>
                    </div>
                </div>
                <button @click="showAchievements = false" class="w-full mt-6 bg-gray-500 text-white py-2 rounded-lg hover:bg-gray-600">
                    Close
                </button>
            </div>
        </div>
    </div>

    <script>
        const { createApp } = Vue;
        
        createApp({
            data() {
                return {
                    currentGame: 'menu',
                    totalScore: 0,
                    currentLevel: 1,
                    gamesCompleted: 0,
                    showScorePopup: false,
                    lastScoreGain: 0,
                    
                    // Difficulty and Timer System
                    difficulty: 'medium',
                    difficultySettings: {
                        easy: { timeLimit: 120, scoreMultiplier: 1, lives: 5 },
                        medium: { timeLimit: 90, scoreMultiplier: 1.5, lives: 3 },
                        hard: { timeLimit: 60, scoreMultiplier: 2, lives: 1 }
                    },
                    gameTimer: 0,
                    timerInterval: null,
                    lives: 3,
                    showDifficultySelector: false,
                    
                    // Achievement System
                    achievements: [
                        { id: 'first_win', name: 'First Victory', description: 'Complete your first game', unlocked: false, icon: 'üèÜ' },
                        { id: 'speed_demon', name: 'Speed Demon', description: 'Complete a game in under 30 seconds', unlocked: false, icon: '‚ö°' },
                        { id: 'perfectionist', name: 'Perfectionist', description: 'Complete a game without losing any lives', unlocked: false, icon: 'üíé' },
                        { id: 'scholar', name: 'Scholar', description: 'Reach 500 total points', unlocked: false, icon: 'üìö' },
                        { id: 'master', name: 'Master Sailor', description: 'Complete all games on hard difficulty', unlocked: false, icon: '‚õµ' }
                    ],
                    showAchievements: false,
                    newAchievement: null,
                    soundEnabled: true,
                    
                    // Leaderboard System
                    leaderboard: [],
                    showLeaderboard: false,
                    
                    // Word Matching Game
                    allWordPairs: [
                        { id: 1, word: 'neighbor', meaning: 'a person living nearby', difficulty: 'easy' },
                        { id: 2, word: 'captain', meaning: 'the person in command of a ship', difficulty: 'easy' },
                        { id: 3, word: 'harbor', meaning: 'a place where ships dock safely', difficulty: 'easy' },
                        { id: 4, word: 'famous', meaning: 'well-known by many people', difficulty: 'easy' },
                        { id: 5, word: 'luck', meaning: 'good fortune or success', difficulty: 'easy' },
                        { id: 6, word: 'sail', meaning: 'to travel by boat using wind power', difficulty: 'easy' },
                        { id: 7, word: 'boat', meaning: 'a small vessel for traveling on water', difficulty: 'easy' },
                        { id: 8, word: 'sea', meaning: 'a large body of salt water', difficulty: 'easy' }
                    ],
                    wordPairs: [],
                    shuffledWords: [],
                    shuffledMeanings: [],
                    wordMatchScore: 0,
                    wordMatchProgress: 0,
                    wordMatchComplete: false,
                    draggedItem: null,
                    
                    // Story Sequencing Game
                    storyEvents: [
                        { id: 1, text: 'Captain Alison will sail from Portsmouth tomorrow', order: 1 },
                        { id: 2, text: 'We will meet him at the harbor early in the morning', order: 2 },
                        { id: 3, text: 'He will be in his small boat Topsail', order: 3 },
                        { id: 4, text: 'Captain Alison will set out at eight o\'clock', order: 4 },
                        { id: 5, text: 'He will take part in an important race across the Atlantic', order: 5 },
                        { id: 6, text: 'We will bid them farewell and wish them good luck', order: 6 }
                    ],
                    scrambledEvents: [],
                    sequenceSlots: [],
                    sequenceScore: 0,
                    sequenceAttempts: 0,
                    sequenceComplete: false,
                    
                    // Sailing Adventure Game
                    sailingQuestions: [
                        {
                            question: 'What is the name of Captain Alison\'s boat?',
                            options: ['Sailboat', 'Topsail', 'Atlantic', 'Portsmouth'],
                            correct: 1
                        },
                        {
                            question: 'Where will Captain Alison sail from?',
                            options: ['London', 'Portsmouth', 'Atlantic', 'Harbor'],
                            correct: 1
                        },
                        {
                            question: 'When will Captain Alison set out?',
                            options: ['Seven o\'clock', 'Eight o\'clock', 'Nine o\'clock', 'Ten o\'clock'],
                            correct: 1
                        },
                        {
                            question: 'What will Captain Alison take part in?',
                            options: ['A party', 'A meeting', 'An important race', 'A celebration'],
                            correct: 2
                        },
                        {
                            question: 'What ocean will Captain Alison cross?',
                            options: ['Pacific Ocean', 'Atlantic Ocean', 'Indian Ocean', 'Arctic Ocean'],
                            correct: 1
                        }
                    ],
                    currentSailingQuestion: null,
                    sailingQuestionIndex: 0,
                    sailingScore: 0,
                    sailingLives: 3,
                    sailingProgress: 0,
                    boatPosition: 0,
                    sailingGameOver: false,
                    sailingWon: false
                }
            },
            
            computed: {
                averageScore() {
                    return this.gamesCompleted > 0 ? (this.totalScore / this.gamesCompleted) : 0;
                },
                
                allSlotsFilled() {
                    return this.sequenceSlots.every(slot => slot.event !== null);
                }
            },
            
            mounted() {
                console.log('Vue app mounted successfully');
                this.initializeGames();
                this.loadLeaderboard();
            },
            
            methods: {
                // Initialize all games
                initializeGames() {
                    this.loadProgress();
                    this.initWordMatch();
                    this.initStorySequence();
                    this.initSailingAdventure();
                },
                
                // Timer and Difficulty Management
                startTimer() {
                    this.gameTimer = this.difficultySettings[this.difficulty].timeLimit;
                    this.lives = this.difficultySettings[this.difficulty].lives;
                    this.timerInterval = setInterval(() => {
                        this.gameTimer--;
                        if (this.gameTimer <= 0) {
                            this.gameOver('Time\'s up!');
                        }
                    }, 1000);
                },
                
                stopTimer() {
                    if (this.timerInterval) {
                        clearInterval(this.timerInterval);
                        this.timerInterval = null;
                    }
                },
                
                formatTime(seconds) {
                    const mins = Math.floor(seconds / 60);
                    const secs = seconds % 60;
                    return `${mins}:${secs.toString().padStart(2, '0')}`;
                },
                
                setDifficulty(level) {
                    this.difficulty = level;
                    this.showDifficultySelector = false;
                    this.saveProgress();
                },
                
                // Sound Effects System
                playSound(type) {
                    if (!this.soundEnabled) return;
                    
                    try {
                        const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                        const oscillator = audioContext.createOscillator();
                        const gainNode = audioContext.createGain();
                        
                        oscillator.connect(gainNode);
                        gainNode.connect(audioContext.destination);
                        
                        switch(type) {
                            case 'correct':
                                oscillator.frequency.setValueAtTime(523.25, audioContext.currentTime);
                                break;
                            case 'wrong':
                                oscillator.frequency.setValueAtTime(220, audioContext.currentTime);
                                break;
                            case 'achievement':
                                oscillator.frequency.setValueAtTime(659.25, audioContext.currentTime);
                                break;
                        }
                        
                        gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
                        
                        oscillator.start(audioContext.currentTime);
                        oscillator.stop(audioContext.currentTime + 0.5);
                    } catch (error) {
                        console.log('Audio not supported');
                    }
                },
                
                toggleSound() {
                    this.soundEnabled = !this.soundEnabled;
                    this.saveProgress();
                },
                
                loseLife() {
                    this.lives--;
                    this.playSound('wrong');
                    if (this.lives <= 0) {
                        this.gameOver('No lives left!');
                    }
                },
                
                gameOver(reason) {
                    this.stopTimer();
                    alert(`Game Over! ${reason}`);
                    this.currentGame = 'menu';
                },
                
                // Achievement System
                unlockAchievement(achievementId) {
                    const achievement = this.achievements.find(a => a.id === achievementId);
                    if (achievement && !achievement.unlocked) {
                        achievement.unlocked = true;
                        this.newAchievement = achievement;
                        this.saveProgress();
                        this.playSound('achievement');
                        setTimeout(() => {
                            this.newAchievement = null;
                        }, 3000);
                    }
                },
                
                checkAchievements() {
                    this.achievements.forEach(achievement => {
                        if (!achievement.unlocked) {
                            let shouldUnlock = false;
                            
                            switch(achievement.id) {
                                case 'first_win':
                                    shouldUnlock = this.gamesCompleted >= 1;
                                    break;
                                case 'scholar':
                                    shouldUnlock = this.totalScore >= 500;
                                    break;
                                case 'speed_demon':
                                    shouldUnlock = this.gameTimer <= 30;
                                    break;
                                case 'perfectionist':
                                    shouldUnlock = this.lives === this.difficultySettings[this.difficulty].lives;
                                    break;
                                case 'master':
                                    shouldUnlock = this.gamesCompleted >= 3 && this.difficulty === 'hard';
                                    break;
                            }
                            
                            if (shouldUnlock) {
                                this.unlockAchievement(achievement.id);
                            }
                        }
                    });
                    
                    this.saveProgress();
                },
                
                // Progress Persistence
                saveProgress() {
                    const progress = {
                        totalScore: this.totalScore,
                        currentLevel: this.currentLevel,
                        gamesCompleted: this.gamesCompleted,
                        difficulty: this.difficulty,
                        achievements: this.achievements
                    };
                    localStorage.setItem('captainAlisonProgress', JSON.stringify(progress));
                },
                
                loadProgress() {
                    const saved = localStorage.getItem('captainAlisonProgress');
                    if (saved) {
                        const progress = JSON.parse(saved);
                        this.totalScore = progress.totalScore || 0;
                        this.currentLevel = progress.currentLevel || 1;
                        this.gamesCompleted = progress.gamesCompleted || 0;
                        this.difficulty = progress.difficulty || 'medium';
                        if (progress.achievements) {
                            progress.achievements.forEach(savedAch => {
                                const achievement = this.achievements.find(a => a.id === savedAch.id);
                                if (achievement) {
                                    achievement.unlocked = savedAch.unlocked;
                                }
                            });
                        }
                    }
                },
                
                startGame(gameType) {
                    this.currentGame = gameType;
                    this.startTimer();
                    
                    if (gameType === 'wordMatch') {
                        this.initWordMatchWithDifficulty();
                    } else if (gameType === 'storySequence') {
                        this.initStorySequence();
                    } else if (gameType === 'sailingAdventure') {
                        this.initSailingAdventure();
                        this.startSailingQuestion();
                    }
                },
                
                showScore(points) {
                    const multipliedPoints = Math.round(points * this.difficultySettings[this.difficulty].scoreMultiplier);
                    this.lastScoreGain = multipliedPoints;
                    this.totalScore += multipliedPoints;
                    this.showScorePopup = true;
                    this.playSound('correct');
                    setTimeout(() => {
                        this.showScorePopup = false;
                    }, 1000);
                    this.saveProgress();
                },
                
                initWordMatchWithDifficulty() {
                    let selectedWords = [];
                    if (this.difficulty === 'easy') {
                        selectedWords = this.allWordPairs.filter(w => w.difficulty === 'easy').slice(0, 4);
                    } else if (this.difficulty === 'medium') {
                        selectedWords = this.allWordPairs.filter(w => w.difficulty === 'easy').slice(0, 6);
                    } else {
                        selectedWords = this.allWordPairs.slice(0, 8);
                    }
                    
                    this.wordPairs = selectedWords;
                    this.initWordMatch();
                },
                
                // Word Matching Game Methods
                initWordMatch() {
                    this.wordMatchScore = 0;
                    this.wordMatchProgress = 0;
                    this.wordMatchComplete = false;
                    
                    this.shuffledWords = this.wordPairs.map(pair => ({
                        ...pair,
                        matched: false
                    })).sort(() => Math.random() - 0.5);
                    
                    this.shuffledMeanings = this.wordPairs.map(pair => ({
                        ...pair,
                        matched: false,
                        matchedWord: '',
                        dragOver: false,
                        incorrect: false
                    })).sort(() => Math.random() - 0.5);
                },
                
                dragStart(event, item) {
                    this.draggedItem = item;
                    event.target.classList.add('dragging');
                },
                
                dragEnd(event) {
                    event.target.classList.remove('dragging');
                },
                
                dragOver(event, target) {
                    if (!target.matched) {
                        target.dragOver = true;
                    }
                },
                
                dragLeave(target) {
                    target.dragOver = false;
                    target.incorrect = false;
                },
                
                drop(event, meaning) {
                    meaning.dragOver = false;
                    
                    if (this.draggedItem && !meaning.matched) {
                        if (this.draggedItem.id === meaning.id) {
                            // Correct match
                            meaning.matched = true;
                            meaning.matchedWord = this.draggedItem.word;
                            this.draggedItem.matched = true;
                            this.wordMatchProgress++;
                            this.wordMatchScore += 10;
                            this.showScore(10);
                            
                            if (this.wordMatchProgress === this.wordPairs.length) {
                                this.wordMatchComplete = true;
                                this.gamesCompleted++;
                                this.stopTimer();
                                this.checkAchievements();
                                this.showScore(50);
                            }
                        } else {
                            // Incorrect match
                            meaning.incorrect = true;
                            this.loseLife();
                            setTimeout(() => {
                                meaning.incorrect = false;
                            }, 1000);
                        }
                    }
                    
                    this.draggedItem = null;
                },
                
                // Story Sequencing Game Methods
                initStorySequence() {
                    this.sequenceScore = 0;
                    this.sequenceAttempts = 0;
                    this.sequenceComplete = false;
                    this.scrambledEvents = [...this.storyEvents].map(event => ({
                        ...event,
                        placed: false
                    })).sort(() => Math.random() - 0.5);
                    
                    this.sequenceSlots = Array(this.storyEvents.length).fill(null).map(() => ({
                        event: null,
                        correct: false,
                        dragOver: false
                    }));
                },
                
                dropSequence(event, slot, index) {
                    slot.dragOver = false;
                    
                    if (this.draggedItem && !slot.event) {
                        slot.event = this.draggedItem;
                        this.draggedItem.placed = true;
                    }
                    
                    this.draggedItem = null;
                },
                
                checkSequence() {
                    this.sequenceAttempts++;
                    let correctCount = 0;
                    
                    this.sequenceSlots.forEach((slot, index) => {
                        if (slot.event && slot.event.order === index + 1) {
                            slot.correct = true;
                            correctCount++;
                        } else {
                            slot.correct = false;
                        }
                    });
                    
                    if (correctCount === this.storyEvents.length) {
                        this.sequenceComplete = true;
                        this.sequenceScore = Math.max(30 - (this.sequenceAttempts - 1) * 5, 10);
                        this.gamesCompleted++;
                        this.stopTimer();
                        this.checkAchievements();
                        this.showScore(this.sequenceScore);
                    } else {
                        // Reset for another attempt
                        setTimeout(() => {
                            this.sequenceSlots.forEach(slot => {
                                if (slot.event) {
                                    slot.event.placed = false;
                                }
                                slot.event = null;
                                slot.correct = false;
                            });
                        }, 2000);
                    }
                },
                
                // Sailing Adventure Game Methods
                initSailingAdventure() {
                    this.sailingQuestionIndex = 0;
                    this.sailingScore = 0;
                    this.sailingLives = 3;
                    this.sailingProgress = 0;
                    this.boatPosition = 0;
                    this.sailingGameOver = false;
                    this.sailingWon = false;
                    this.currentSailingQuestion = null;
                },
                
                startSailingQuestion() {
                    if (this.sailingQuestionIndex < this.sailingQuestions.length) {
                        this.currentSailingQuestion = this.sailingQuestions[this.sailingQuestionIndex];
                    } else {
                        this.sailingWon = true;
                        this.sailingGameOver = true;
                        this.gamesCompleted++;
                        this.stopTimer();
                        this.checkAchievements();
                        this.showScore(100);
                    }
                },
                
                answerSailingQuestion(selectedIndex) {
                    if (selectedIndex === this.currentSailingQuestion.correct) {
                        // Correct answer
                        this.sailingScore += 20;
                        this.sailingProgress += 20;
                        this.boatPosition += 20;
                        this.showScore(20);
                        
                        this.sailingQuestionIndex++;
                        setTimeout(() => {
                            this.startSailingQuestion();
                        }, 1000);
                    } else {
                        // Wrong answer
                        this.loseLife();
                        this.sailingLives = this.lives;
                        if (this.lives <= 0) {
                            this.sailingGameOver = true;
                            this.sailingWon = false;
                            this.stopTimer();
                        }
                    }
                },
                
                resetSailingGame() {
                    this.initSailingAdventure();
                    this.startSailingQuestion();
                },
                
                // Leaderboard Methods
                loadLeaderboard() {
                    const saved = localStorage.getItem('lesson12_leaderboard');
                    if (saved) {
                        this.leaderboard = JSON.parse(saved);
                    } else {
                        // Add sample data for testing
                        this.leaderboard = [
                            {
                                name: 'Captain Alison',
                                score: 450,
                                date: new Date().toLocaleDateString(),
                                gamesCompleted: 3,
                                difficulty: 'hard'
                            },
                            {
                                name: 'Sailor Bob',
                                score: 320,
                                date: new Date().toLocaleDateString(),
                                gamesCompleted: 3,
                                difficulty: 'medium'
                            },
                            {
                                name: 'Navigator Jane',
                                score: 280,
                                date: new Date().toLocaleDateString(),
                                gamesCompleted: 3,
                                difficulty: 'easy'
                            }
                        ];
                        this.saveLeaderboard();
                    }
                },
                
                saveLeaderboard() {
                    localStorage.setItem('lesson12_leaderboard', JSON.stringify(this.leaderboard));
                },
                
                addToLeaderboard(name, score) {
                    const entry = {
                        name: name,
                        score: score,
                        date: new Date().toLocaleDateString(),
                        gamesCompleted: this.gamesCompleted,
                        difficulty: this.difficulty
                    };
                    
                    this.leaderboard.push(entry);
                    this.leaderboard.sort((a, b) => b.score - a.score);
                    this.leaderboard = this.leaderboard.slice(0, 10);
                    this.saveLeaderboard();
                },
                
                toggleLeaderboard() {
                    this.showLeaderboard = !this.showLeaderboard;
                },
                
                clearLeaderboard() {
                    if (confirm('Are you sure you want to clear the leaderboard?')) {
                        this.leaderboard = [];
                        this.saveLeaderboard();
                    }
                },
                
                // Helper method for medal icons
                getMedalIcon(index) {
                    if (index === 0) return 'ü•á';
                    if (index === 1) return 'ü•à';
                    if (index === 2) return 'ü•â';
                    return 'üèÖ';
                }
            }
        }).mount('#app');
    </script>
</body>
</html>